<div class="animated fadeIn" ng-controller="appointmentImportController">
    <div class="row">
        <div class="col-md-12">            
            <div class="card">
              <div class="card-header">
                <h5>Appointment Import</h5>
              </div>
              <div class="card-block">
                <form name="importExcelForm" novalidate>
                    <div class="form-group">
                        <label><i class="icon-user"></i> Upload Excel</label>
                        <input type="file" name="importfile" class="form-control" id="importappointment" import-sheet-js="">
                        <span class="danger-color" ng-if="!maxrowtoimport">We can upload maximum 400 appointments at once</span>
                        <span class="danger-color" ng-if="!datainfile">No data in file</span>
                    </div>
                </form>
              </div>
              <div class="card">
                <div class="card-block" ng-if="displayNxtImportForm">
                  <div class="row">
                      <div class="col-sm-2">
                         
                              <small class="text-muted">Visit date</small>
                              <br>
                               <datepicker date-format="yyyy-MM-dd">
                                <input ng-model="visitdate" type="text" class="form-control" ng-change="checkVisitDate(visitdate)"/>
                              </datepicker>
                              <span class="danger-color" ng-if="!visitdateavilable">Please mention visit date</span>
                      </div>
                      <!--/.col-->
                      <div class="col-sm-2">
                         
                              <small class="text-muted">Visit Expire date</small>
                              <br>
                              <datepicker date-format="yyyy-MM-dd">
                                <input ng-model="visitexpiredate" type="text" class="form-control" ng-change="checkExpireVisitDate(visitexpiredate)"/>
                              </datepicker>
                              <span class="danger-color" ng-if="!visitexpiredateavilable">Please mention visit expire date</span>
                      </div>
                      <!--/.col-->
                      <div class="col-sm-2">
                          
                              <small class="text-muted">Company To Visit</small>
                              <br>
                              <select class="custom-select" ng-model="tovisit" ng-options="item as item.displaylabel for item in listOfCompany track by item.companyid" ng-change="checkToCompany(tovisit)"> </select>
                              <span class="danger-color" ng-if="!tocompanyavailable">Please select company to visit</span>
                      </div>
                      <div class="col-sm-2">
                          
                              <small class="text-muted">Purpose</small>
                              <br>
                              <select class="custom-select" ng-model="purpose" ng-options="x for x in companyPurpose" ng-change="checkPurpose(purpose)"> </select>
                              <span class="danger-color" ng-if="!purposeavailable">Please select a purpose</span>

                      </div>
                      <div class="col-sm-2" ng-hide="companyPreference.useidcard < 1">       
                              <small class="text-muted">Id card</small>
                              <br>
                              <select class="custom-select" ng-model="idcard" ng-options="x for x in allIdTypes" ng-change="checkIdCard(idcard)"> </select>
                              <span class="danger-color"  ng-if="!idcardavailable">Please select a id card type</span>
                      </div>
                      <div class="col-sm-2">       
                              <br>
                              <button class="btn btn-success" ng-click="importData(importedAppointmentData, visitdate, visitexpiredate, tovisit, purpose,idcard)">Import</button>
                      </div>

                  </div>
              </div>

              <div ng-if="displayInvalildData" class="card-block" >
                <div class="row">
                  <div class="col-sm-12">
                    <span class="danger-color">Invalid data. Check your file once. </span>
                  </div>
                </div>
              </div>
            </div>
        </div>
        <!--/.col-->
    </div>
    <!--/.row-->
</div>



